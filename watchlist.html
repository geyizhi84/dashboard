<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sovereign Alpha Terminal</title>
    <style>
        :root { --bg: #06090f; --panel: #131722; --accent: #2962ff; --border: #2a2e39; --text: #d1d4dc; }
        body { background: var(--bg); color: var(--text); font-family: 'Inter', sans-serif; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; border: 1px solid var(--border); background: var(--panel); border-radius: 4px; }
        .header { padding: 15px; border-bottom: 2px solid var(--accent); font-weight: 800; display: flex; justify-content: space-between; }
        table { width: 100%; border-collapse: collapse; font-size: 14px; }
        th { text-align: left; padding: 12px; color: #787b86; border-bottom: 1px solid var(--border); font-size: 11px; text-transform: uppercase; }
        td { padding: 12px; border-bottom: 1px solid #1c252e; font-family: 'Roboto Mono', monospace; }
        .pos { color: #22c55e; } .neg { color: #ef4444; }
        .ticker { color: var(--accent); font-weight: bold; font-family: 'Inter', sans-serif; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <span>SOVEREIGN // LIVE FEED</span>
        <span id="status" style="font-size: 10px; color: #787b86;">READY</span>
    </div>
    <table id="market-table">
        <thead>
            <tr>
                <th>Symbol</th>
                <th>Price</th>
                <th>Change %</th>
                <th>Volume</th>
            </tr>
        </thead>
        <tbody id="table-body">
            </tbody>
    </table>
</div>

<script>
    const API_KEY = 'F2T5EKCV5X2Y57HW';
    const TICKERS = ['SPY', 'QQQ', 'BTCUSD', 'GOLD']; // Note: BTCUSD and GOLD depend on Alpha Vantage coverage

    async function fetchQuote(symbol) {
        const url = `https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${symbol}&apikey=${API_KEY}`;
        try {
            const response = await fetch(url);
            const data = await response.json();
            return data["Global Quote"];
        } catch (e) {
            console.error("Fetch error for " + symbol, e);
            return null;
        }
    }

    async function updateDashboard() {
        const tbody = document.getElementById('table-body');
        const status = document.getElementById('status');
        status.innerText = "REFRESHING...";
        
        // Clear existing rows
        tbody.innerHTML = '';

        for (const symbol of TICKERS) {
            const quote = await fetchQuote(symbol);
            if (!quote || !quote["05. price"]) continue;

            const price = parseFloat(quote["05. price"]).toFixed(2);
            const changePct = quote["10. change percent"];
            const isPos = !changePct.includes('-');

            const row = `
                <tr>
                    <td class="ticker">${symbol}</td>
                    <td>${price}</td>
                    <td class="${isPos ? 'pos' : 'neg'}">${changePct}</td>
                    <td style="color:#787b86">${parseInt(quote["06. volume"]).toLocaleString()}</td>
                </tr>
            `;
            tbody.innerHTML += row;

            // Free Tier throttle: Alpha Vantage free keys have a per-minute limit.
            // We wait 1 second between requests to be safe.
            await new Promise(r => setTimeout(r, 1000));
        }
        status.innerText = "UPDATED: " + new Date().toLocaleTimeString();
    }

    // Initial load
    updateDashboard();
    // Refresh every 5 minutes to stay within free tier limits (5 calls/min)
    setInterval(updateDashboard, 300000);
</script>
</body>
</html>
