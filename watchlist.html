<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sovereign Terminal | Google Engine</title>
    <style>
        :root {
            --bg: #ffffff; --header-bg: #e2e2e2; --sub-header: #fdb927;
            --pos-bg: #c6efce; --pos-text: #006100; --neg-bg: #ffc7ce; --neg-text: #9c0006;
            --border: #d1d1d1;
        }
        body { font-family: 'Segoe UI', Arial, sans-serif; background: #f4f4f4; padding: 20px; margin: 0; }
        .container { background: white; max-width: 1100px; margin: 0 auto; border: 1px solid #000; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .main-title { font-size: 24px; font-weight: 900; padding: 10px 15px; border-bottom: 2px solid black; display: flex; justify-content: space-between; align-items: center; }
        .group-header { background: var(--sub-header); font-weight: bold; font-size: 13px; padding: 5px 15px; border-top: 1px solid black; border-bottom: 1px solid black; text-align: left; }
        table { width: 100%; border-collapse: collapse; table-layout: fixed; }
        thead th { background: var(--header-bg); border: 1px solid var(--border); padding: 8px; font-size: 11px; }
        .ytd-header { background: #000; color: #fff; }
        td { padding: 8px; font-size: 13px; border: 1px solid var(--border); text-align: center; }
        .ticker { font-weight: bold; text-align: left; padding-left: 15px; }
        .price { font-family: monospace; font-weight: bold; text-align: right; padding-right: 15px; }
        .pct { font-weight: 600; text-align: right; padding-right: 10px; }
        .pos { background-color: var(--pos-bg); color: var(--pos-text); }
        .neg { background-color: var(--neg-bg); color: var(--neg-text); }
    </style>
</head>
<body>

<div class="container">
    <div class="main-title">
        <span>Market Watchlist</span>
        <span id="sync-status" style="font-size: 11px; font-weight: normal; color: #666;">Syncing Google Finance...</span>
    </div>

    <div id="table-output">
        <div style="padding: 50px; text-align: center; color: #999;">Connecting to Google Sheets Engine...</div>
    </div>
</div>

<script>
    // 1. PASTE YOUR SHEET ID HERE
    const SHEET_ID = '1dRwSDyMGotW_RArjMCAEaDBhsTJyz92nUggktC2lBGw'; 
    const DATA_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv`;

    async function updateTerminal() {
        try {
            const response = await fetch(DATA_URL);
            const csv = await response.text();
            const rows = csv.split('\n').map(r => r.split(',').map(c => c.replace(/"/g, ''))).slice(1);

            let html = `<table><thead><tr>
                <th style="width:120px">Ticker</th>
                <th>Price</th>
                <th>1D %</th>
                <th>5D %</th>
                <th class="ytd-header">YTD %</th>
            </tr></thead><tbody>`;

            html += `<tr><td colspan="5" class="group-header">1. EQUITIES & CHINA FOCUS</td></tr>`;

            rows.forEach(row => {
                if (!row[0]) return;
                const ticker = row[0].includes(':') ? row[0].split(':')[1] : row[0];
                const price = parseFloat(row[1]).toFixed(2);
                const d1 = (parseFloat(row[2]) * 100).toFixed(2);
                const d5 = (parseFloat(row[3]) * 100).toFixed(2);
                const ytd = (parseFloat(row[4]) * 100).toFixed(2);

                html += `
                    <tr>
                        <td class="ticker">${ticker}</td>
                        <td class="price">${price}</td>
                        <td class="pct ${d1 >= 0 ? 'pos' : 'neg'}">${d1}%</td>
                        <td class="pct ${d5 >= 0 ? 'pos' : 'neg'}">${d5}%</td>
                        <td class="pct ${ytd >= 0 ? 'pos' : 'neg'}">${ytd}%</td>
                    </tr>
                `;
            });

            html += `</tbody></table>`;
            document.getElementById('table-output').innerHTML = html;
            document.getElementById('sync-status').innerText = 'Last Sync: ' + new Date().toLocaleTimeString();
        } catch (e) {
            document.getElementById('table-output').innerHTML = '<div style="padding:20px; color:red;">Connection Error: Ensure Sheet is shared as "Anyone with link can view".</div>';
        }
    }

    // High-frequency auto-refresh (every 60 seconds)
    setInterval(updateTerminal, 60000);
    updateTerminal();
</script>
</body>
</html>
